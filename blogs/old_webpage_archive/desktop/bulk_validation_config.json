{
  "_meta": {
    "version": "2.0",
    "source": "Amazon Advertising Bulksheets API Documentation",
    "last_updated": "2025-12",
    "description": "Exhaustive validation rules for Amazon bulk upload files"
  },

  "file_level_rules": {
    "max_rows": 10000,
    "supported_formats": [".xlsx", ".xls", ".csv"],
    "encoding": "UTF-8",
    "header_required": true,
    "empty_rows_allowed": false
  },

  "currency_limits": {
    "SP": {
      "USD": {"min_budget": 1, "max_budget": 1000000, "min_bid": 0.02, "max_bid": 1000},
      "GBP": {"min_budget": 1, "max_budget": 1000000, "min_bid": 0.02, "max_bid": 1000},
      "EUR": {"min_budget": 1, "max_budget": 1000000, "min_bid": 0.02, "max_bid": 1000},
      "CAD": {"min_budget": 1, "max_budget": 1000000, "min_bid": 0.02, "max_bid": 1000},
      "AUD": {"min_budget": 1.4, "max_budget": 1500000, "min_bid": 0.1, "max_bid": 1410},
      "JPY": {"min_budget": 100, "max_budget": 21000000, "min_bid": 2, "max_bid": 100000},
      "INR": {"min_budget": 500, "max_budget": 21000000, "min_bid": 1, "max_bid": 5000},
      "AED": {"min_budget": 4, "max_budget": 3700000, "min_bid": 0.24, "max_bid": 3670},
      "MXN": {"min_budget": 1, "max_budget": 21000000, "min_bid": 0.1, "max_bid": 20000},
      "CNY": {"min_budget": 1, "max_budget": 21000000, "min_bid": 0.1, "max_bid": 1000}
    },
    "SB": {
      "USD": {"min_daily": 1, "max_daily": 1000000, "min_lifetime": 100, "max_lifetime": 20000000, "min_bid": 0.1, "max_bid": 49},
      "GBP": {"min_daily": 1, "max_daily": 1000000, "min_lifetime": 100, "max_lifetime": 20000000, "min_bid": 0.1, "max_bid": 31},
      "EUR": {"min_daily": 1, "max_daily": 1000000, "min_lifetime": 100, "max_lifetime": 20000000, "min_bid": 0.1, "max_bid": 39},
      "AED": {"min_daily": 4, "max_daily": 3700000, "min_lifetime": 367, "max_lifetime": 74000000, "min_bid": 0.4, "max_bid": 184}
    },
    "SD": {
      "USD": {"min_budget": 1, "max_budget": 1000000, "min_bid": 0.02, "max_bid": 1000}
    }
  },

  "record_types": {
    "sponsored_products": {
      "Campaign": {
        "columns": {
          "Record ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false,
            "data_type": "string",
            "error_code": "ID002"
          },
          "Record Type": {
            "required": true,
            "mutable": false,
            "allowed_values": ["Campaign"],
            "error_code": "RT001"
          },
          "Campaign ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false,
            "error_code": "CAM005"
          },
          "Campaign": {
            "required": true,
            "mutable": true,
            "max_length": 128,
            "pattern": "^[a-zA-Z0-9\\s\\-_\\.,!?'\"&()]+$",
            "error_code": "CAM001"
          },
          "Campaign Daily Budget": {
            "required": true,
            "mutable": true,
            "data_type": "decimal",
            "min_value": "currency_dependent",
            "max_value": "currency_dependent",
            "error_code": "BUD001"
          },
          "Portfolio ID": {
            "required": false,
            "mutable": true,
            "error_code": "POR001"
          },
          "Campaign Start Date": {
            "required": true,
            "mutable": true,
            "data_type": "date",
            "format": "mm/dd/yyyy",
            "validation": "not_in_past",
            "error_code": "DAT001"
          },
          "Campaign End Date": {
            "required": false,
            "mutable": true,
            "data_type": "date",
            "format": "mm/dd/yyyy",
            "validation": "after_start_date",
            "error_code": "DAT004"
          },
          "Campaign Targeting Type": {
            "required": true,
            "mutable": false,
            "allowed_values": ["Auto", "Manual"],
            "error_code": "TAR001"
          },
          "Campaign Status": {
            "required": true,
            "mutable": true,
            "allowed_values": ["enabled", "paused", "archived", "Enabled", "Paused", "Archived"],
            "error_code": "STA001"
          },
          "Bidding Strategy": {
            "required": true,
            "mutable": false,
            "allowed_values": [
              "Fixed Bids",
              "Dynamic bidding (up and down)",
              "Dynamic bidding (down only)"
            ],
            "error_code": "BID001"
          }
        }
      },

      "Campaign By Placement": {
        "parent": "Campaign",
        "columns": {
          "Record ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false
          },
          "Record Type": {
            "required": true,
            "mutable": false,
            "allowed_values": ["Campaign By Placement"]
          },
          "Campaign ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false
          },
          "Campaign": {
            "required": true,
            "mutable": false
          },
          "Placement Type": {
            "required": true,
            "mutable": false,
            "allowed_values": ["Top of search (page 1)", "Product Pages"],
            "invalid_values": ["Top of Search", "Product Detail Page", "Other Placements", "Rest of search"],
            "error_code": "PLC001",
            "notes": "Amazon rejects 'Rest of search' for bid adjustments"
          },
          "Increase Bids By Placement": {
            "required": true,
            "mutable": true,
            "data_type": "integer",
            "min_value": 0,
            "max_value": 900,
            "format_notes": "% sign optional, decimals forbidden",
            "error_code": "PLC002"
          }
        }
      },

      "Ad Group": {
        "parent": "Campaign",
        "columns": {
          "Record ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false
          },
          "Record Type": {
            "required": true,
            "mutable": false,
            "allowed_values": ["Ad Group"]
          },
          "Campaign ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false
          },
          "Campaign": {
            "required": true,
            "mutable": false,
            "notes": "Must match parent campaign name exactly (case-sensitive)"
          },
          "Ad Group": {
            "required": true,
            "mutable": false,
            "max_length": 255,
            "error_code": "ADG001"
          },
          "Max Bid": {
            "required": true,
            "mutable": true,
            "data_type": "decimal",
            "min_value": "currency_dependent",
            "max_value": "currency_dependent",
            "error_code": "MAX001"
          },
          "Ad Group Status": {
            "required": true,
            "mutable": true,
            "allowed_values": ["enabled", "paused", "archived", "Enabled", "Paused", "Archived"]
          }
        }
      },

      "Keyword": {
        "parent": "Ad Group",
        "max_per_parent": 1000,
        "columns": {
          "Record ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false
          },
          "Record Type": {
            "required": true,
            "mutable": false,
            "allowed_values": ["Keyword"]
          },
          "Campaign ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false
          },
          "Campaign": {
            "required": true,
            "mutable": false
          },
          "Ad Group": {
            "required": false,
            "mutable": false,
            "conditional_required": {
              "when": "Match Type",
              "in": ["broad", "phrase", "exact", "negative phrase", "negative exact"]
            },
            "notes": "Leave blank for campaign-level negative keywords"
          },
          "Max Bid": {
            "required": false,
            "mutable": true,
            "data_type": "decimal",
            "min_value": "currency_dependent",
            "max_value": "currency_dependent",
            "conditional_required": {
              "when": "Match Type",
              "in": ["broad", "phrase", "exact"]
            },
            "notes": "Required for biddable keywords, leave blank for negatives"
          },
          "Keyword or Product Targeting": {
            "required": true,
            "mutable": false,
            "max_length": 80,
            "pattern": "^[a-zA-Z0-9\\s\\-]+$",
            "validation": {
              "max_words_positive": 10,
              "max_words_negative": 4,
              "max_words_negative_exact": 10
            },
            "error_code": "KEY001"
          },
          "Match Type": {
            "required": true,
            "mutable": false,
            "allowed_values": [
              "broad",
              "phrase", 
              "exact",
              "negative phrase",
              "negative exact",
              "campaign negative phrase",
              "campaign negative exact"
            ],
            "case_sensitive": false,
            "error_code": "KEY007"
          },
          "Status": {
            "required": true,
            "mutable": true,
            "allowed_values": ["enabled", "paused", "archived"],
            "allowed_values_campaign_negative": ["enabled", "deleted"],
            "error_code": "STA001"
          }
        }
      },

      "Product Targeting": {
        "parent": "Ad Group",
        "columns": {
          "Record ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false
          },
          "Record Type": {
            "required": true,
            "mutable": false,
            "allowed_values": ["Product Targeting"]
          },
          "Campaign ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false
          },
          "Campaign": {
            "required": true,
            "mutable": false
          },
          "Ad Group": {
            "required": true,
            "mutable": false
          },
          "Max Bid": {
            "required": true,
            "mutable": true,
            "data_type": "decimal",
            "min_value": "currency_dependent",
            "max_value": "currency_dependent"
          },
          "Keyword or Product Targeting": {
            "required": true,
            "mutable": false,
            "format_patterns": [
              "asin=\"B0XXXXXXXXX\"",
              "category=\"CategoryName\"",
              "brand=\"BrandName\""
            ],
            "error_code": "PT002"
          },
          "Product Targeting ID": {
            "required": false,
            "mutable": false,
            "allowed_values": ["close-match", "substitutes", "loose-match", "complements"],
            "notes": "For auto-targeting campaigns only"
          },
          "Match Type": {
            "required": true,
            "mutable": false,
            "allowed_values": [
              "Targeting Expression",
              "negativetargetingexpression",
              "Targeting Expression Predefined"
            ]
          },
          "Status": {
            "required": true,
            "mutable": true,
            "allowed_values": ["enabled", "paused", "archived"]
          }
        }
      },

      "Ad": {
        "parent": "Ad Group",
        "columns": {
          "Record ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false
          },
          "Record Type": {
            "required": true,
            "mutable": false,
            "allowed_values": ["Ad"]
          },
          "Campaign ID": {
            "required_create": false,
            "required_update": true,
            "mutable": false
          },
          "Campaign": {
            "required": true,
            "mutable": false
          },
          "Ad Group": {
            "required": true,
            "mutable": false
          },
          "SKU": {
            "required": true,
            "mutable": false,
            "notes": "Sellers use SKU, vendors use ASIN",
            "error_code": "AD001"
          },
          "Status": {
            "required": true,
            "mutable": true,
            "allowed_values": ["enabled", "paused", "archived"]
          }
        }
      }
    }
  },

  "validation_flags": {
    "errors": {
      "F001": {"severity": "fatal", "message": "Missing header row"},
      "F002": {"severity": "fatal", "message": "Invalid file format"},
      "F003": {"severity": "fatal", "message": "Encoding error"},
      "F004": {"severity": "fatal", "message": "Max rows exceeded (10,000)"},
      "F005": {"severity": "fatal", "message": "Empty file"},
      
      "C001": {"severity": "error", "message": "Required column missing: {column}"},
      
      "ID001": {"severity": "error", "message": "Record ID modified"},
      "ID002": {"severity": "error", "message": "Record ID required for update"},
      "ID003": {"severity": "error", "message": "Record ID not found"},
      
      "CAM001": {"severity": "error", "message": "Campaign name required"},
      "CAM002": {"severity": "error", "message": "Campaign name > 128 chars"},
      "CAM003": {"severity": "error", "message": "Campaign name invalid characters"},
      "CAM004": {"severity": "error", "message": "Campaign not found"},
      "CAM005": {"severity": "error", "message": "Campaign ID required for update"},
      
      "BUD001": {"severity": "error", "message": "Budget required"},
      "BUD002": {"severity": "error", "message": "Budget below minimum"},
      "BUD003": {"severity": "error", "message": "Budget exceeds maximum"},
      "BUD004": {"severity": "error", "message": "Invalid budget format"},
      
      "DAT001": {"severity": "error", "message": "Start date required"},
      "DAT002": {"severity": "error", "message": "Invalid date format (use mm/dd/yyyy)"},
      "DAT003": {"severity": "error", "message": "Start date in past"},
      "DAT005": {"severity": "error", "message": "End date before start date"},
      
      "TAR001": {"severity": "error", "message": "Targeting type required"},
      "TAR002": {"severity": "error", "message": "Invalid targeting type"},
      
      "STA001": {"severity": "error", "message": "Status required"},
      "STA002": {"severity": "error", "message": "Invalid status value"},
      "STA003": {"severity": "error", "message": "Cannot update archived entity"},
      
      "BID001": {"severity": "error", "message": "Bidding strategy required"},
      "BID002": {"severity": "error", "message": "Invalid bidding strategy"},
      
      "ADG001": {"severity": "error", "message": "Ad group name required"},
      "ADG002": {"severity": "error", "message": "Ad group name > 255 chars"},
      "ADG003": {"severity": "error", "message": "Ad group not found"},
      
      "MAX001": {"severity": "error", "message": "Max bid required"},
      "MAX002": {"severity": "error", "message": "Bid below minimum"},
      "MAX003": {"severity": "error", "message": "Bid exceeds maximum"},
      "MAX004": {"severity": "error", "message": "Invalid bid format"},
      
      "KEY001": {"severity": "error", "message": "Keyword required"},
      "KEY002": {"severity": "error", "message": "Keyword > 80 chars"},
      "KEY003": {"severity": "error", "message": "Keyword invalid characters"},
      "KEY004": {"severity": "error", "message": "Keyword too many words"},
      "KEY005": {"severity": "error", "message": "Duplicate keyword in ad group"},
      "KEY007": {"severity": "error", "message": "Match type required"},
      "KEY008": {"severity": "error", "message": "Invalid match type"},
      "KEY009": {"severity": "error", "message": "Cannot add keywords to auto campaign"},
      
      "PT001": {"severity": "error", "message": "Invalid ASIN format"},
      "PT002": {"severity": "error", "message": "Invalid targeting expression"},
      
      "AD001": {"severity": "error", "message": "SKU required"},
      
      "PLC001": {"severity": "error", "message": "Invalid placement type"},
      "PLC002": {"severity": "error", "message": "Invalid placement bid format"},
      "PLC003": {"severity": "error", "message": "Placement bid > 900%"},
      
      "HIE001": {"severity": "error", "message": "Parent entity missing"},
      "HIE002": {"severity": "error", "message": "Parent entity failed, child skipped"},
      
      "R002": {"severity": "error", "message": "Duplicate row"}
    },
    
    "warnings": {
      "W001": {"severity": "warning", "message": "Target is paused"},
      "W002": {"severity": "warning", "message": "Campaign is paused"},
      "W003": {"severity": "warning", "message": "Bid unusually low"},
      "W004": {"severity": "warning", "message": "Budget increase > 200%"},
      "W005": {"severity": "warning", "message": "Negative matches active target"},
      "MAX005": {"severity": "warning", "message": "Bid change > 300%"},
      "KEY006": {"severity": "warning", "message": "Keyword matches existing negative"}
    }
  },

  "special_validation_rules": {
    "asin_format": {
      "pattern": "^B0[A-Z0-9]{8}$",
      "description": "10 alphanumeric chars, starts with B0"
    },
    "date_format": {
      "pattern": "^\\d{1,2}/\\d{1,2}/\\d{4}$",
      "format": "mm/dd/yyyy"
    },
    "targeting_expression": {
      "patterns": [
        "^asin=\"[A-Z0-9]{10}\"$",
        "^category=\".+\"$",
        "^brand=\".+\"$"
      ]
    },
    "bid_multiplier": {
      "pattern": "^[+-]\\d+(\\.\\d{1,2})?%$",
      "min": -99.00,
      "max": 99.99,
      "required_chars": ["+/-", "%"]
    },
    "keyword_word_limits": {
      "positive_keywords": 10,
      "negative_keywords": 4,
      "negative_exact": 10
    }
  },

  "entity_hierarchy": {
    "sponsored_products": {
      "Campaign": {
        "children": ["Ad Group", "Campaign By Placement"],
        "required_for_children": true
      },
      "Ad Group": {
        "parent": "Campaign",
        "children": ["Keyword", "Product Targeting", "Ad"],
        "required_for_children": true
      },
      "Keyword": {
        "parent": "Ad Group",
        "max_per_parent": 1000
      },
      "Product Targeting": {
        "parent": "Ad Group"
      },
      "Ad": {
        "parent": "Ad Group"
      }
    }
  },

  "read_only_columns": [
    "Impressions",
    "Clicks", 
    "Spend",
    "Orders",
    "Total Units",
    "Sales",
    "ACoS"
  ],

  "immutable_on_update": [
    "Record ID",
    "Record Type",
    "Campaign Targeting Type",
    "Bidding Strategy",
    "Ad Group",
    "Keyword or Product Targeting",
    "Match Type",
    "SKU"
  ],

  "business_logic_rules": {
    "negative_keywords": {
      "isolation_harvest": {
        "description": "Campaign-level negatives to prevent cannibalization after promoting keywords",
        "purpose": "Block harvested keywords in source campaign",
        "rules": {
          "match_type": {
            "allowed": ["campaign negative exact", "campaign negative phrase"],
            "preferred": "campaign negative exact"
          },
          "ad_group": {
            "required": false,
            "must_be_blank": true,
            "error_if_populated": "ISO001"
          },
          "status": {
            "allowed": ["enabled", "deleted"],
            "not_allowed": ["paused", "archived"],
            "error_code": "ISO003"
          },
          "max_bid": {
            "must_be_blank": true
          }
        },
        "applies_to_campaign_types": ["Auto", "Manual"]
      },
      
      "bleeder": {
        "description": "Ad group-level negatives to block poor-performing search terms",
        "purpose": "Stop wasted spend on bad performers within specific ad group",
        "rules": {
          "match_type": {
            "allowed": ["negative exact", "negative phrase"],
            "not_allowed": ["campaign negative exact", "campaign negative phrase"]
          },
          "ad_group": {
            "required": true,
            "must_match_existing": true,
            "error_if_missing": "BLD001"
          },
          "status": {
            "allowed": ["enabled", "paused", "archived"]
          },
          "max_bid": {
            "must_be_blank": true
          }
        },
        "applies_to_campaign_types": ["Auto", "Manual"]
      }
    },

    "bid_updates": {
      "description": "Changing bids on existing keywords or ad groups",
      "rules": {
        "record_id": {
          "required": true,
          "error_if_missing": "BID_UPD001"
        },
        "campaign_id": {
          "required": true
        },
        "max_bid": {
          "required": true,
          "validate_currency_limits": true,
          "warn_if_change_exceeds_percent": 300,
          "warning_code": "BID_UPD003"
        }
      },
      "applies_to_record_types": ["Keyword", "Ad Group"]
    },

    "auto_campaign_restrictions": {
      "description": "What can and cannot be added to Auto-targeting campaigns",
      "forbidden_operations": {
        "add_positive_keywords": {
          "match_types": ["broad", "phrase", "exact"],
          "error_code": "AUTO001",
          "message": "Cannot add positive keywords to Auto campaigns"
        }
      },
      "allowed_operations": {
        "add_campaign_negatives": {
          "match_types": ["campaign negative exact", "campaign negative phrase"]
        },
        "add_ad_group_negatives": {
          "match_types": ["negative exact", "negative phrase"]
        },
        "update_bids": true,
        "update_status": true,
        "add_product_targeting": {
          "targeting_ids": ["close-match", "substitutes", "loose-match", "complements"]
        }
      }
    },

    "campaign_creation": {
      "description": "Rules for creating new campaigns",
      "rules": {
        "record_id": {
          "must_be_blank": true
        },
        "campaign_id": {
          "must_be_blank": true
        },
        "required_fields": [
          "Record Type",
          "Campaign",
          "Campaign Daily Budget",
          "Campaign Start Date",
          "Campaign Targeting Type",
          "Campaign Status",
          "Bidding Strategy"
        ],
        "name_uniqueness": {
          "case_sensitive": true,
          "must_be_unique_in_account": true
        }
      }
    }
  },

  "business_error_codes": {
    "ISO001": {
      "severity": "error",
      "message": "Ad Group must be BLANK for isolation/harvest negatives (campaign-level)"
    },
    "ISO002": {
      "severity": "error", 
      "message": "Isolation negatives must use 'campaign negative exact' or 'campaign negative phrase'"
    },
    "ISO003": {
      "severity": "error",
      "message": "Campaign-level negatives only support 'enabled' or 'deleted' status"
    },
    "BLD001": {
      "severity": "error",
      "message": "Ad Group is REQUIRED for bleeder negatives (ad group-level)"
    },
    "BLD002": {
      "severity": "error",
      "message": "Bleeder negatives must use 'negative exact' or 'negative phrase'"
    },
    "BID_UPD001": {
      "severity": "error",
      "message": "Record ID is required for bid updates"
    },
    "BID_UPD002": {
      "severity": "error",
      "message": "Bid value outside currency limits"
    },
    "BID_UPD003": {
      "severity": "warning",
      "message": "Bid change exceeds 300%"
    },
    "AUTO001": {
      "severity": "error",
      "message": "Cannot add positive keywords to Auto-targeting campaign"
    }
  },

  "recommendation_level_validation": {
    "_description": "Validate at source architecture - validation happens when optimizer generates recommendations, not at export",
    
    "recommendation_types": {
      "negative_isolation": {
        "description": "Campaign-level negative to prevent cannibalization after harvest",
        "record_type": "Keyword",
        "validations": {
          "ad_group": {"must_be_blank": true, "error_code": "ISO001"},
          "match_type": {"allowed": ["campaign negative exact", "campaign negative phrase"], "error_code": "ISO002"},
          "max_bid": {"must_be_blank": true}
        },
        "works_with_auto_campaigns": true
      },
      
      "negative_bleeder": {
        "description": "Ad group-level negative to block poor performers",
        "record_type": "Keyword",
        "validations": {
          "ad_group": {"required": true, "error_code": "BLD001"},
          "match_type": {"allowed": ["negative exact", "negative phrase"], "error_code": "BLD002"},
          "max_bid": {"must_be_blank": true}
        },
        "works_with_auto_campaigns": true
      },
      
      "bid_increase": {
        "description": "Increase bid on keyword or ad group",
        "record_type": "Keyword",
        "validations": {
          "new_bid": {"required": true, "validate_currency_limits": true},
          "ad_group": {"required": true},
          "warn_if_change_exceeds_percent": 300
        }
      },
      
      "bid_decrease": {
        "description": "Decrease bid on keyword or ad group",
        "record_type": "Keyword",
        "validations": {
          "new_bid": {"required": true, "validate_currency_limits": true},
          "ad_group": {"required": true},
          "warn_if_change_exceeds_percent": 300
        }
      },
      
      "keyword_harvest": {
        "description": "Promote keyword to its own campaign",
        "record_type": "Keyword",
        "validations": {
          "keyword_text": {"required": true},
          "match_type": {"allowed": ["broad", "phrase", "exact"]},
          "auto_campaign_check": {"block_if_auto": true, "error_code": "AUTO001"}
        }
      },
      
      "pause_target": {
        "description": "Pause a keyword or target",
        "record_type": "Keyword",
        "validations": {
          "target_identifier": {"required": true}
        }
      },
      
      "enable_target": {
        "description": "Enable a paused keyword or target",
        "record_type": "Keyword",
        "validations": {
          "target_identifier": {"required": true}
        }
      }
    },
    
    "ui_behavior": {
      "valid": {
        "icon": "✅",
        "checkbox": "enabled",
        "row_style": "normal",
        "can_export": true
      },
      "warning": {
        "icon": "⚠️",
        "checkbox": "enabled",
        "row_style": "yellow_highlight",
        "can_export": true,
        "requires_acknowledgment": true
      },
      "invalid": {
        "icon": "❌",
        "checkbox": "disabled",
        "row_style": "greyed_out",
        "can_export": false,
        "show_error_message": true
      }
    },
    
    "export_rules": {
      "only_export_if_can_execute": true,
      "can_execute_definition": "is_valid AND is_selected",
      "warnings_can_export": true,
      "errors_cannot_export": true
    }
  }
}
